(function(){var e=Nokia.util,d=function(){},a="landscape",b="portrait",c="miniview";Nokia.ViewManager=new Nokia.Class({initialize:function(g){var f=this;f.options=jQuery.extend({beforeRender:d,render:d,beforeShow:d,show:d},g);f.viewStack=[];f.history=[];f._currentHistoryIndex=f._currentIndex=0},next:function(){var f=this,g=f.getCurrentIndex();f.show(f.viewStack[++g])},prev:function(){var f=this,g=f.getCurrentIndex();f.show(f.viewStack[--g])},back:function(){var g=this;if(g._currentHistoryIndex>0){var f=g.history[--g._currentHistoryIndex];if(history){g._show.apply(g,f.args)}}},forward:function(){var f=this;if(f._currentHistoryIndex<f.history.length-1){var g=f.history[++f._currentHistoryIndex];f._show.apply(f,g.args)}},clearHistory:function(){var f=this;f.history=[]},clear:function(){var f=this;f.viewStack=[]},show:function(h){var g=this;h=g._getView(h);if(h){var i=g.getCurrentHistoryIndex();var f={view:h,args:arguments};g.history.splice(i+1,0,f);g._currentHistoryIndex=jQuery.inArray(f,g.history);g._show.apply(g,arguments)}},_getView:function(g){var f=this;if(e.isNumber(g)){g=f.viewStack[g]}if(g instanceof Nokia.View){var h=jQuery.inArray(g,f.viewStack);if(h>-1){return g}}return null},_show:function(){var f=this,g=f._getView(arguments[0]);if(!g.isRendered()){f.options.beforeRender.apply(f,[g]);g.render();f.options.render.apply(f,[g])}f.hideAll();f.setCurrentIndex(jQuery.inArray(g,f.viewStack));f.options.show.apply(f,[g]);g.show.apply(g,Array.prototype.slice.call(arguments,1))},hide:function(){var f=this,g=f.getCurrentView();g.hide.apply(g,Array.prototype.slice.call(arguments,1))},hideAll:function(){var f=this;jQuery.each(f.viewStack,function(h,g){g.hide()})},getCurrentView:function(){var f=this;return f.viewStack[f.getCurrentIndex()]},getCurrentHistoryIndex:function(){var f=this;return f._currentHistoryIndex},getCurrentIndex:function(){var f=this;return(f._currentIndex||0)},setCurrentIndex:function(g){var f=this;if(g<=f.viewStack.length&&g>=0){f._currentIndex=g}},add:function(g){var f=this;if(g instanceof Nokia.View){f.viewStack.push(g)}},remove:function(g){var f=this;if(e.isNumber(g)){e.arrayRemove(f.viewStack,g)}else{if(g instanceof Nokia.View){f.viewStack.splice(jQuery.inArray(g,f.viewStack),1)}}},getViews:function(){var f=this;return f.viewStack},getHistorySize:function(){var f=this;return f.history.length},size:function(){var f=this;return f.viewStack.length},inLandscapeMode:function(){var f=this;return f.getViewMode()==a},inPortraitMode:function(){var f=this;return f.getViewMode()==b},inMiniviewMode:function(){var f=this;return f.getViewMode()==c},isNonTouch:function(){var f=this;return(window.innerHeight*window.innerWidth)<360*640},getViewMode:function(){var f=this,g=window.innerHeight;if(f.isNonTouch()){if(g>240){return b}else{return a}}else{if(g<=150){return c}else{if(g>150&&g<=360){return a}else{return b}}}}})})();